# Практическая работа №6

## Цели
Необходимо разработать (автономную) диалоговую программную систему или подсистему для программного продукта, создаваемого в рамках магистерского исследования. Например, в формате чат-бота. Рекомендуется использовать результаты, полученные при выполнении предыдущих практических работ. Внимание: допускается использовать любые известные подходы к генерации осмысленных предложений, кроме шаблонного.

Программную реализацию необходимо разместить в любом открытом GIT-репозитории. В файле README необходимо привести инструкцию по сборке, развертыванию и использованию генератора осмысленных предложений, его сравнение с генератором на основе шаблонов (в том числе с пользовательскими данными). Альтернативно - создать архив проекта (с документацией), разместить в облачном хранилище. Допустимые форматы: zip, tar.gz, 7z.

## Задачи
- Рекомендуется использовать ранее полученные результаты;
- Провести нормализацию данных;
- Разработать (автономную) диалоговую программную систему;
- В файле README привести инструкцию по сборке, развертыванию и использованию анализатора с примерами его работы, в том числе с пользовательскими данными;
- Разместить программную реализацию в Git-репозитории.

## Решение
Файл `lab6.ipynb` содержит программную реализацию, диалоговой программной системы, разработанной в формате чат-бота. 

В ходе разаработки было принято решение заменить датасет, который содержал тексты песен группы *Imagine Dragons*, на новый. В качестве нового набора данных был взят *Cornell Movie Dialogs Corpus*, содержащий диалоги персонажей художественных фильмов. Для решения поставленной задачи были задействованы файлы `movie_lines.txt` и `movie_conversations.txt`

Обучение модели строилось на анализе этих диалогов: система последовательно изучала пары реплик, чтобы научиться предсказывать продолжение высказывания на основе предыдущего контекста. Постепенно модель улавливала типичные языковые конструкции и устойчивые связи между репликами собеседников. Параметры сети корректировались с помощью градиентного спуска, а эффективность обучения оценивалась по функции потерь, отражающей расхождение между предсказанными и реальными ответами. В результате модель научилась генерировать осмысленные ответы в рамках диалога, не используя заранее заданные шаблоны или архитектуры sequence-to-sequence.

## Результат
Модель обучалась на 1000 пар диалогов в течение 10 эпох. Обучение составляет порядка 5 минут.
```
Epoch 1, loss=5.8586
Epoch 2, loss=4.8555
Epoch 3, loss=3.8161
Epoch 4, loss=2.5839
Epoch 5, loss=1.5493
Epoch 6, loss=0.9007
Epoch 7, loss=0.5091
Epoch 8, loss=0.3037
Epoch 9, loss=0.1868
Epoch 10, loss=0.1253
```
Пример обения с чат-ботом:
```
'exit' - выйти из чата
Вы:  hi
Бот: looks like things worked out tonight, huh
Вы:  i don't know
Бот: what i think of it
Вы:  tell me
Бот: you need therapy has anyone ever told you that
Вы:  no
Бот: what about back home
```
Также были проведены тесты с использованием 6000 пар диалогов, однако существенной разницы это не дало. 

Сравнивая результаты данной практической работы с предыдущей, можно заметить значительный прогресс. Вероятно, качество ответов чат-бота можно улучшить, если использовать диалоги из более бытовых жанров кино при обучении, так как на данный момент ответы кажутся слегка драматичными.

## Формат ввода
Опционально для обучения чат-бота на своих данных можно вставить свои реплики в файлы `data\movie_conversations.txt` и `data\movie_lines.txt`.

`movie_conversations.txt` – описывает структуру диалогов между персонажами. Пример ввода:
```
u100 +++$+++ u101 +++$+++ m0 +++$+++ ['L6000','L6001']
```
`movie_lines.txt` – содержит отдельные реплики персонажей. Пример ввода:
```
L6000 +++$+++ u100 +++$+++ m0 +++$+++ NAME1 +++$+++ TEXT1
L6001 +++$+++ u101 +++$+++ m0 +++$+++ NAME2 +++$+++ TEXT2
```

## Инструкция по сборке:
- Клонировать данный репозиторий командой: ```git clone https://github.com/so1ed/MoNLP_lab.git```
- Перейти в нужную директорию командой: ```cd MoNLP_lab\lab6```
- В python окружении запустить: ```pip install -r requirements.txt```
- Добавить свои реплики в файлы из папки `data` *(опционально)*
- Выполнить команду: ```jupyter notebook lab6.ipynb```